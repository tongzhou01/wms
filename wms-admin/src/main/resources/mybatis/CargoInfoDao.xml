<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mz.admin.dao.CargoInfoDao">
    <resultMap id="BaseResultMap" type="com.mz.admin.entity.CargoInfo">
        <id column="id" jdbcType="BIGINT" property="id"/>
        <result column="cn_no" jdbcType="VARCHAR" property="cnNo"/>
        <result column="intl_no" jdbcType="VARCHAR" property="intlNo"/>
        <result column="order_no" jdbcType="VARCHAR" property="orderNo"/>
        <result column="customer_no" jdbcType="VARCHAR" property="customerNo"/>
        <result column="express_company_code" jdbcType="VARCHAR" property="expressCompanyCode"/>
        <result column="express_company" jdbcType="VARCHAR" property="expressCompany"/>
        <result column="shelf_no" jdbcType="VARCHAR" property="shelfNo"/>
        <result column="destination" jdbcType="VARCHAR" property="destination"/>
        <result column="weight" jdbcType="DECIMAL" property="weight"/>
        <result column="length" jdbcType="DECIMAL" property="length"/>
        <result column="wide" jdbcType="DECIMAL" property="wide"/>
        <result column="height" jdbcType="DECIMAL" property="height"/>
        <result column="volume_weight" jdbcType="DECIMAL" property="volumeWeight"/>
        <result column="cargo_charge" jdbcType="DECIMAL" property="cargoCharge"/>
        <result column="express_charge" jdbcType="DECIMAL" property="expressCharge"/>
        <result column="gmt_create" jdbcType="TIMESTAMP" property="gmtCreate"/>
        <result column="gmt_modify" jdbcType="TIMESTAMP" property="gmtModify"/>
        <result column="status" jdbcType="TINYINT" property="status"/>
        <result column="is_deleted" jdbcType="TINYINT" property="isDeleted"/>
    </resultMap>
    <resultMap id="CargoDetail" type="com.mz.admin.model.CargoDetailVO" autoMapping="true">
        <association property="customerInfo" javaType="com.mz.admin.entity.CustomerInfo" autoMapping="true">
            <id column="customer_id" jdbcType="BIGINT" property="id"/>
        </association>
        <collection property="operateRecords" ofType="com.mz.admin.entity.OperateRecord">
            <result column="scan_time" jdbcType="TIMESTAMP" property="scanTime"/>
            <result column="type" jdbcType="TINYINT" property="type"/>
        </collection>
    </resultMap>
    <sql id="Base_Column_List">
        id, cn_no, intl_no, order_no, customer_no, express_company_code, express_company,
        shelf_no, destination, weight, length, wide, height, volume_weight, cargo_charge,
        express_charge, gmt_create, gmt_modify, status, is_deleted
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
        select
        <include refid="Base_Column_List"/>
        from cargo_info
        where id = #{id,jdbcType=BIGINT}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
        delete from cargo_info
        where id = #{id,jdbcType=BIGINT}
    </delete>
    <insert id="insert" parameterType="com.mz.admin.entity.CargoInfo">
        insert into cargo_info (id, cn_no, intl_no,
        order_no, customer_no,
        express_company_code, express_company, shelf_no,
        destination, weight, length,
        wide, height, volume_weight,
        cargo_charge, express_charge, gmt_create,
        gmt_modify, status, is_deleted
        )
        values (#{id,jdbcType=BIGINT}, #{cnNo,jdbcType=VARCHAR}, #{intlNo,jdbcType=VARCHAR},
        #{orderNo,jdbcType=VARCHAR}, #{customerNo,jdbcType=VARCHAR},
        #{expressCompanyCode,jdbcType=VARCHAR}, #{expressCompany,jdbcType=VARCHAR}, #{shelfNo,jdbcType=VARCHAR},
        #{destination,jdbcType=VARCHAR}, #{weight,jdbcType=DECIMAL}, #{length,jdbcType=DECIMAL},
        #{wide,jdbcType=DECIMAL}, #{height,jdbcType=DECIMAL}, #{volumeWeight,jdbcType=DECIMAL},
        #{cargoCharge,jdbcType=DECIMAL}, #{expressCharge,jdbcType=DECIMAL}, #{gmtCreate,jdbcType=TIMESTAMP},
        #{gmtModify,jdbcType=TIMESTAMP}, #{status,jdbcType=TINYINT}, #{isDeleted,jdbcType=TINYINT}
        )
    </insert>
    <insert id="insertSelective" parameterType="com.mz.admin.entity.CargoInfo" useGeneratedKeys="true" keyProperty="id">
        insert into cargo_info
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                id,
            </if>
            <if test="cnNo != null">
                cn_no,
            </if>
            <if test="intlNo != null">
                intl_no,
            </if>
            <if test="orderNo != null">
                order_no,
            </if>
            <if test="customerNo != null">
                customer_no,
            </if>
            <if test="expressCompanyCode != null">
                express_company_code,
            </if>
            <if test="expressCompany != null">
                express_company,
            </if>
            <if test="shelfNo != null">
                shelf_no,
            </if>
            <if test="destination != null">
                destination,
            </if>
            <if test="weight != null">
                weight,
            </if>
            <if test="length != null">
                length,
            </if>
            <if test="wide != null">
                wide,
            </if>
            <if test="height != null">
                height,
            </if>
            <if test="volumeWeight != null">
                volume_weight,
            </if>
            <if test="cargoCharge != null">
                cargo_charge,
            </if>
            <if test="expressCharge != null">
                express_charge,
            </if>
            <if test="gmtCreate != null">
                gmt_create,
            </if>
            <if test="gmtModify != null">
                gmt_modify,
            </if>
            <if test="status != null">
                status,
            </if>
            <if test="isDeleted != null">
                is_deleted,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=BIGINT},
            </if>
            <if test="cnNo != null">
                #{cnNo,jdbcType=VARCHAR},
            </if>
            <if test="intlNo != null">
                #{intlNo,jdbcType=VARCHAR},
            </if>
            <if test="orderNo != null">
                #{orderNo,jdbcType=VARCHAR},
            </if>
            <if test="customerNo != null">
                #{customerNo,jdbcType=VARCHAR},
            </if>
            <if test="expressCompanyCode != null">
                #{expressCompanyCode,jdbcType=VARCHAR},
            </if>
            <if test="expressCompany != null">
                #{expressCompany,jdbcType=VARCHAR},
            </if>
            <if test="shelfNo != null">
                #{shelfNo,jdbcType=VARCHAR},
            </if>
            <if test="destination != null">
                #{destination,jdbcType=VARCHAR},
            </if>
            <if test="weight != null">
                #{weight,jdbcType=DECIMAL},
            </if>
            <if test="length != null">
                #{length,jdbcType=DECIMAL},
            </if>
            <if test="wide != null">
                #{wide,jdbcType=DECIMAL},
            </if>
            <if test="height != null">
                #{height,jdbcType=DECIMAL},
            </if>
            <if test="volumeWeight != null">
                #{volumeWeight,jdbcType=DECIMAL},
            </if>
            <if test="cargoCharge != null">
                #{cargoCharge,jdbcType=DECIMAL},
            </if>
            <if test="expressCharge != null">
                #{expressCharge,jdbcType=DECIMAL},
            </if>
            <if test="gmtCreate != null">
                #{gmtCreate,jdbcType=TIMESTAMP},
            </if>
            <if test="gmtModify != null">
                #{gmtModify,jdbcType=TIMESTAMP},
            </if>
            <if test="status != null">
                #{status,jdbcType=TINYINT},
            </if>
            <if test="isDeleted != null">
                #{isDeleted,jdbcType=TINYINT},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.mz.admin.entity.CargoInfo">
        update cargo_info
        <set>
            <if test="cnNo != null">
                cn_no = #{cnNo,jdbcType=VARCHAR},
            </if>
            <if test="intlNo != null">
                intl_no = #{intlNo,jdbcType=VARCHAR},
            </if>
            <if test="orderNo != null">
                order_no = #{orderNo,jdbcType=VARCHAR},
            </if>
            <if test="customerNo != null">
                customer_no = #{customerNo,jdbcType=VARCHAR},
            </if>
            <if test="expressCompanyCode != null">
                express_company_code = #{expressCompanyCode,jdbcType=VARCHAR},
            </if>
            <if test="expressCompany != null">
                express_company = #{expressCompany,jdbcType=VARCHAR},
            </if>
            <if test="shelfNo != null">
                shelf_no = #{shelfNo,jdbcType=VARCHAR},
            </if>
            <if test="destination != null">
                destination = #{destination,jdbcType=VARCHAR},
            </if>
            <if test="weight != null">
                weight = #{weight,jdbcType=DECIMAL},
            </if>
            <if test="length != null">
                length = #{length,jdbcType=DECIMAL},
            </if>
            <if test="wide != null">
                wide = #{wide,jdbcType=DECIMAL},
            </if>
            <if test="height != null">
                height = #{height,jdbcType=DECIMAL},
            </if>
            <if test="volumeWeight != null">
                volume_weight = #{volumeWeight,jdbcType=DECIMAL},
            </if>
            <if test="cargoCharge != null">
                cargo_charge = #{cargoCharge,jdbcType=DECIMAL},
            </if>
            <if test="expressCharge != null">
                express_charge = #{expressCharge,jdbcType=DECIMAL},
            </if>
            <if test="gmtCreate != null">
                gmt_create = #{gmtCreate,jdbcType=TIMESTAMP},
            </if>
            <if test="gmtModify != null">
                gmt_modify = #{gmtModify,jdbcType=TIMESTAMP},
            </if>
            <if test="status != null">
                status = #{status,jdbcType=TINYINT},
            </if>
            <if test="isDeleted != null">
                is_deleted = #{isDeleted,jdbcType=TINYINT},
            </if>
        </set>
        where id = #{id,jdbcType=BIGINT}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.mz.admin.entity.CargoInfo">
        update cargo_info
        set cn_no = #{cnNo,jdbcType=VARCHAR},
        intl_no = #{intlNo,jdbcType=VARCHAR},
        order_no = #{orderNo,jdbcType=VARCHAR},
        customer_no = #{customerNo,jdbcType=VARCHAR},
        express_company_code = #{expressCompanyCode,jdbcType=VARCHAR},
        express_company = #{expressCompany,jdbcType=VARCHAR},
        shelf_no = #{shelfNo,jdbcType=VARCHAR},
        destination = #{destination,jdbcType=VARCHAR},
        weight = #{weight,jdbcType=DECIMAL},
        length = #{length,jdbcType=DECIMAL},
        wide = #{wide,jdbcType=DECIMAL},
        height = #{height,jdbcType=DECIMAL},
        volume_weight = #{volumeWeight,jdbcType=DECIMAL},
        cargo_charge = #{cargoCharge,jdbcType=DECIMAL},
        express_charge = #{expressCharge,jdbcType=DECIMAL},
        gmt_create = #{gmtCreate,jdbcType=TIMESTAMP},
        gmt_modify = #{gmtModify,jdbcType=TIMESTAMP},
        status = #{status,jdbcType=TINYINT},
        is_deleted = #{isDeleted,jdbcType=TINYINT}
        where id = #{id,jdbcType=BIGINT}
    </update>
    <select id="index" resultType="java.util.Map">
        SELECT
        c.*,
        o.type,
        o.scan_time,
        ci.customer_name,
        ci.customer_address,
        ci.customer_company,
        ci.customer_mobile,
        ci.balance,
        ci.total_amount
        FROM cargo_info c,operate_record o, customer_info ci
        WHERE c.id = o.cargo_id AND ci.customer_no = c.customer_no AND c.is_deleted = 0
        AND o.type = #{type}
        <if test="orderNo != null">
            AND c.order_no LIKE CONCAT("%",#{orderNo},"%")
        </if>
        <if test="customerNo != null">
            AND c.customer_no LIKE CONCAT("%",#{customerNo},"%")
        </if>
        <if test="startDate != null and endDate != null">
            AND c.gmt_create <![CDATA[>=]]> #{startDate}
            AND c.gmt_create <![CDATA[<=]]> #{startDate}
        </if>
        ORDER BY o.scan_time DESC
        <if test="currentPage != null and pageSize!=null">
            limit ${(currentPage-1) * pageSize},${pageSize}
        </if>
    </select>
    <select id="count" resultType="java.lang.Integer">
        SELECT count(1) FROM cargo_info c,operate_record o, customer_info ci WHERE c.id = o.cargo_id AND ci.customer_no = c.customer_no AND c.is_deleted = 0
            AND o.type = #{type}
        <if test="orderNo != null">
            AND c.order_no LIKE CONCAT("%",#{orderNo},"%")
        </if>
        <if test="customerNo != null">
            AND c.customer_no LIKE CONCAT("%",#{customerNo},"%")
        </if>
        <if test="startDate != null and endDate != null">
            AND c.gmt_create <![CDATA[>=]]> #{startDate}
            AND c.gmt_create <![CDATA[<=]]> #{startDate}
        </if>
    </select>
    <select id="getDetail" resultMap="CargoDetail">
        SELECT
        c.*,
        o.type,
        o.scan_time,
        ci.customer_name,
        ci.id customer_id,
        ci.customer_address,
        ci.customer_company,
        ci.customer_mobile,
        ci.balance,
        ci.total_amount
        FROM cargo_info c,operate_record o, customer_info ci
        WHERE c.id = o.cargo_id AND ci.customer_no = c.customer_no AND c.is_deleted = 0 AND c.shelf_no = #{shelfNo}
        <if test="orderNo != null">
            AND c.order_no LIKE CONCAT("%",#{orderNo},"%")
        </if>
        <if test="customerNo != null">
            AND c.customer_no LIKE CONCAT("%",#{customerNo},"%")
        </if>
        <if test="startDate != null and endDate != null">
            AND c.gmt_create <![CDATA[>=]]> #{startDate}
            AND c.gmt_create <![CDATA[<=]]> #{startDate}
        </if>
        ORDER BY o.scan_time DESC
        <if test="currentPage != null and pageSize!=null">
            limit ${(currentPage-1) * pageSize},${pageSize}
        </if>
    </select>
</mapper>